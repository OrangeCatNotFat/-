{"ast":null,"code":"var _jsxFileName = \"E:\\\\\\u88C5\\u4FEE\\u5C0F\\u7A0B\\u5E8F\\\\decorate\\\\src\\\\components\\\\case.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport { BrowserRouter } from \"react-router-dom\";\nimport { Button, Input, Card, PageHeader, Modal, Form, Upload, Row, Col, message, Image } from \"antd\";\nimport BraftEditor from \"braft-editor\"; // 引入富文本编辑器\n\nimport \"braft-editor/dist/index.css\";\nimport { ExclamationCircleOutlined, PlusOutlined, VerticalAlignTopOutlined } from \"@ant-design/icons\";\nimport { HOST, PORT } from \"../config/apiconfig\";\nimport TextArea from \"antd/es/input/TextArea\";\nimport axios from \"axios\"; // 引入css样式\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Case = function (props) {\n  _s();\n\n  const [isAdd, setIsAdd] = useState(false); // 记录是否是添加页面\n\n  const [fileList, setFileList] = useState([]); // 图片文件列表\n\n  const [previewVisiable, setPreviewVisiable] = useState(false); // 记录预览图片的模态框是否打开\n\n  const [previewTitle, setPreviewTitle] = useState(\"\"); // 模态框上现实的图片的标题\n\n  const [previewImage, setPreviewImage] = useState(\"\"); // 预览的图片文件\n\n  const [publishVisiable, setPublishVisiable] = useState(false);\n  const [state, setState] = useState(false); // 记录当前页面数据是否修改\n\n  const [allCase, setAllCase] = useState([]); // 用来存放所有的案例\n\n  const addCaseRef = /*#__PURE__*/React.createRef(); // 与添加案例表单绑定\n\n  const handleImgChange = _ref => {\n    let {\n      fileList: newFileList\n    } = _ref;\n    // 点击上传图片之后，将上传的图片存放在数组\n    setFileList(newFileList);\n  };\n\n  const back = () => {\n    // 退出添加页面的模态框\n    Modal.confirm({\n      title: \"确认退出\",\n      icon: /*#__PURE__*/_jsxDEV(ExclamationCircleOutlined, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 30,\n        columnNumber: 19\n      }, this),\n      content: \"您的文章将不会被保存\",\n      okText: \"确认\",\n      cancelText: \"取消\",\n      onOk: () => {\n        setIsAdd(false);\n        setFileList([]);\n      }\n    });\n  };\n\n  const getBase64 = file => {\n    // 读取图片文件\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader(); // 创建读取文件的对象\n\n      reader.readAsDataURL(file); // 读取文件的url\n\n      reader.onload = () => resolve(reader.result); // 返回文件内容\n\n\n      reader.onerror = err => reject(err);\n    });\n  };\n\n  const uploadButton =\n  /*#__PURE__*/\n  // 未上传图片时显示的按钮\n  _jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(PlusOutlined, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: \"8px\"\n      },\n      children: \"\\u4E0A\\u4F20\\u5C01\\u9762\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 51,\n    columnNumber: 9\n  }, this);\n\n  const handlePreview = async file => {\n    // 图片预览功能，在模态框中预览\n    if (!file.url && !file.preview) {\n      // 如果文件没有打开且没有预览，则打开并且预览\n      file.preview = await getBase64(file.originFileObj);\n    }\n\n    setPreviewVisiable(true); // 显示模态框\n\n    setPreviewImage(file.url || file.preview); // 预览图片文件\n\n    setPreviewTitle(file.name || file.url.substring(file.url.lastIndexOf(\"/\") + 1)); // 上传图片的标题\n  };\n\n  const beforeUpload = file => {\n    // 上传前的格式检查\n    const isCorrect = file.type === \"image/jpeg\" || file.type === \"image/png\";\n\n    if (!isCorrect) {\n      message.error(\"请上传JPG或PNG格式的图片\");\n      return Upload.LIST_IGNORE;\n    }\n\n    return isCorrect;\n  };\n\n  const publish = async () => {\n    // 点击发布之后弹出模态框\n    await addCaseRef.current.validateFields().then(value => {\n      if (value.braft == undefined || fileList.length == 0 || value.img == undefined || fileList[0].response == undefined) {\n        message.info(\"请上传封面\");\n        return;\n      }\n\n      Modal.confirm({\n        title: \"你确定发布文章吗\",\n        visible: publishVisiable,\n        onCancel: setPublishVisiable(false),\n        centered: true,\n        okText: \"确定\",\n        cancelText: \"取消\",\n        onOk: () => submit()\n      });\n    });\n  };\n\n  const submit = async () => {\n    // 发布文章\n    await addCaseRef.current.validateFields().then(value => {\n      const event = {\n        name: value.name,\n        img: fileList[0].response.imgPath,\n        desc: value.desc,\n        content: value.braft.toHTML()\n      };\n      axios.post(`${HOST}:${PORT}/case/add`, {\n        event: event\n      }).then(result => {\n        if (result.data.status === 201) {\n          message.success(result.data.msg);\n          setFileList([]);\n          setTimeout(() => {\n            setIsAdd(false);\n          }, 1000);\n          setState(!state);\n        }\n\n        if (result.data.status === 422) {\n          message.info(\"请上传封面\");\n        }\n      }).catch(err => {\n        console.log(err);\n      });\n    });\n  };\n\n  const addPage = () => {\n    // 添加案例\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(PageHeader, {\n        className: \"site-page-header\",\n        onBack: () => back(),\n        title: \"编辑案例\",\n        extra: [/*#__PURE__*/_jsxDEV(Button, {\n          type: \"primary\",\n          onClick: () => back(),\n          children: \"\\u53D6\\u6D88\\u7F16\\u8F91\"\n        }, 1, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          type: \"primary\",\n          onClick: () => publish(),\n          children: \"\\u53D1\\u5E03\\u6587\\u7AE0\"\n        }, 2, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 21\n        }, this)]\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Form, {\n        ref: addCaseRef,\n        children: [/*#__PURE__*/_jsxDEV(Row, {\n          align: \"center\",\n          children: /*#__PURE__*/_jsxDEV(Col, {\n            span: 23,\n            children: /*#__PURE__*/_jsxDEV(Form.Item, {\n              name: \"name\",\n              defaultValue: \"【无标题】\",\n              rules: [{\n                required: true,\n                message: \"请输入文章标题\"\n              }],\n              children: /*#__PURE__*/_jsxDEV(Input, {\n                placeholder: \"请输入文章标题\",\n                style: {\n                  borderRadius: \"24px\",\n                  height: \"40px\",\n                  padding: \"8px\"\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 136,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 134,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Row, {\n          align: \"center\",\n          children: /*#__PURE__*/_jsxDEV(Col, {\n            span: 23,\n            children: /*#__PURE__*/_jsxDEV(Form.Item, {\n              name: \"braft\",\n              rules: [{\n                required: true,\n                message: \"请输入正文\"\n              }],\n              children: /*#__PURE__*/_jsxDEV(BraftEditor, {\n                placeholder: \"在这里输入正文\",\n                style: {\n                  border: \"1px solid #d9d9d9\"\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 144,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 143,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Row, {\n          align: \"center\",\n          children: [/*#__PURE__*/_jsxDEV(Col, {\n            span: 3,\n            children: /*#__PURE__*/_jsxDEV(Form.Item, {\n              name: \"img\",\n              children: /*#__PURE__*/_jsxDEV(Upload, {\n                action: `${HOST}:${PORT}/case/upload` // 上传\n                ,\n                name: \"img\" // 发到后台的文件参数名\n                ,\n                listType: \"picture-card\",\n                fileList: fileList,\n                onChange: handleImgChange,\n                data: file => ({\n                  photoContent: file\n                }) // 用户选择的文件\n                ,\n                onPreview: handlePreview,\n                beforeUpload: beforeUpload,\n                children: fileList.length >= 1 ? null : uploadButton\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 151,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 150,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Col, {\n            span: 13,\n            children: /*#__PURE__*/_jsxDEV(Form.Item, {\n              name: \"desc\",\n              rules: [{\n                required: true,\n                message: \"请输入文章摘要\"\n              }],\n              children: /*#__PURE__*/_jsxDEV(TextArea, {\n                placeholder: \"请输入文章摘要\",\n                autoSize: {\n                  minRows: 4,\n                  maxRows: 4\n                },\n                style: {\n                  width: \"700px\"\n                },\n                showCount: true,\n                maxLength: 255\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 163,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 162,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Modal, {\n        visible: previewVisiable,\n        title: previewTitle,\n        onCancel: () => setPreviewVisiable(false),\n        footer: null,\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          alt: \"example\",\n          style: {\n            width: \"100%\"\n          },\n          src: previewImage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 13\n    }, this);\n  }; // 查询所有的案例\n\n\n  const getAllCase = () => {\n    axios.get(`${HOST}:${PORT}/case/all`).then(result => {\n      if (result.data.status === 200) {\n        setAllCase(result.data.data);\n      }\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n\n  useEffect(() => getAllCase(), [state]); // 记录什么时候刷新数据\n\n  const casePage = () => {\n    // 显示案例\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Input.Group, {\n        compact: true,\n        children: [/*#__PURE__*/_jsxDEV(Input, {\n          style: {\n            width: \"200px\"\n          },\n          placeholder: \"请输入案例名称\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 21\n        }, this), \"\\xA0\\xA0\\xA0\", /*#__PURE__*/_jsxDEV(Button, {\n          type: \"primary\",\n          children: \"\\u641C\\u7D22\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 21\n        }, this), \"\\xA0\\xA0\\xA0\", /*#__PURE__*/_jsxDEV(Button, {\n          type: \"primary\",\n          onClick: () => {\n            setIsAdd(true);\n          },\n          children: \"\\u6DFB\\u52A0\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: \"20px\"\n        },\n        children: allCase.map(item => {\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: \"flex\",\n              flexDirection: \"row\",\n              flex: 1\n            },\n            children: /*#__PURE__*/_jsxDEV(Card, {\n              hoverable: true,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  width: \"220px\",\n                  height: \"125px\",\n                  border: \"1px solid black\"\n                },\n                children: /*#__PURE__*/_jsxDEV(Image, {\n                  src: item.img,\n                  width: 220,\n                  height: 123.75,\n                  preview: false,\n                  placeholder: true\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 212,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 207,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  marginLeft: \"20px\",\n                  width: \"500px\",\n                  height: \"125px\",\n                  backgroundColor: \"orange\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    fontSize: \"20px\"\n                  },\n                  children: item.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 220,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    backgroundColor: \"pink\",\n                    marginTop: \"10px\"\n                  },\n                  children: item.desc\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 221,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 215,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(Button, {\n                    children: \"\\u7F16\\u8F91\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 228,\n                    columnNumber: 49\n                  }, this), /*#__PURE__*/_jsxDEV(Button, {\n                    children: \"\\u5220\\u9664\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 229,\n                    columnNumber: 49\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 227,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [\"\\u53D1\\u5E03\\u65F6\\u95F4\\uFF1A\", item.created_at, \"\\xA0\\xA0\\xA0\\u66F4\\u65B0\\u65F6\\u95F4\\uFF1A\", item.updated_at]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 231,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 226,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 206,\n              columnNumber: 37\n            }, this)\n          }, item.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 205,\n            columnNumber: 33\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 13\n    }, this);\n  };\n\n  return /*#__PURE__*/_jsxDEV(BrowserRouter, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: \"30px 20px\"\n      },\n      children: isAdd ? addPage() : casePage()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 244,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Case, \"AfKUHHlj78eSX/nvZV7E8IJvBrQ=\");\n\n_c = Case;\nexport default Case;\n\nvar _c;\n\n$RefreshReg$(_c, \"Case\");","map":{"version":3,"sources":["E:/装修小程序/decorate/src/components/case.js"],"names":["React","useEffect","useState","BrowserRouter","Button","Input","Card","PageHeader","Modal","Form","Upload","Row","Col","message","Image","BraftEditor","ExclamationCircleOutlined","PlusOutlined","VerticalAlignTopOutlined","HOST","PORT","TextArea","axios","Case","props","isAdd","setIsAdd","fileList","setFileList","previewVisiable","setPreviewVisiable","previewTitle","setPreviewTitle","previewImage","setPreviewImage","publishVisiable","setPublishVisiable","state","setState","allCase","setAllCase","addCaseRef","createRef","handleImgChange","newFileList","back","confirm","title","icon","content","okText","cancelText","onOk","getBase64","file","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","err","uploadButton","marginTop","handlePreview","url","preview","originFileObj","name","substring","lastIndexOf","beforeUpload","isCorrect","type","error","LIST_IGNORE","publish","current","validateFields","then","value","braft","undefined","length","img","response","info","visible","onCancel","centered","submit","event","imgPath","desc","toHTML","post","data","status","success","msg","setTimeout","catch","console","log","addPage","required","borderRadius","height","padding","border","photoContent","minRows","maxRows","width","getAllCase","get","casePage","map","item","display","flexDirection","flex","marginLeft","backgroundColor","fontSize","created_at","updated_at","id"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from \"react\";\r\nimport {BrowserRouter} from \"react-router-dom\";\r\nimport {Button, Input, Card, PageHeader, Modal, Form, Upload, Row, Col, message, Image} from \"antd\";\r\nimport BraftEditor from \"braft-editor\"; // 引入富文本编辑器\r\nimport \"braft-editor/dist/index.css\";\r\nimport {ExclamationCircleOutlined, PlusOutlined, VerticalAlignTopOutlined} from \"@ant-design/icons\";\r\nimport {HOST, PORT} from \"../config/apiconfig\";\r\nimport TextArea from \"antd/es/input/TextArea\";\r\nimport axios from \"axios\"; // 引入css样式\r\n\r\nconst Case = function (props) {\r\n    const [isAdd, setIsAdd] = useState(false); // 记录是否是添加页面\r\n    const [fileList, setFileList] = useState([]); // 图片文件列表\r\n    const [previewVisiable, setPreviewVisiable] = useState(false); // 记录预览图片的模态框是否打开\r\n    const [previewTitle, setPreviewTitle] = useState(\"\"); // 模态框上现实的图片的标题\r\n    const [previewImage, setPreviewImage] = useState(\"\"); // 预览的图片文件\r\n    const [publishVisiable, setPublishVisiable] = useState(false);\r\n    const [state, setState] = useState(false); // 记录当前页面数据是否修改\r\n    const [allCase, setAllCase] = useState([]); // 用来存放所有的案例\r\n\r\n    const addCaseRef = React.createRef(); // 与添加案例表单绑定\r\n\r\n    const handleImgChange = ({fileList: newFileList}) => { // 点击上传图片之后，将上传的图片存放在数组\r\n        setFileList(newFileList);\r\n    }\r\n\r\n    const back = () => { // 退出添加页面的模态框\r\n        Modal.confirm({\r\n            title: \"确认退出\",\r\n            icon: <ExclamationCircleOutlined/>,\r\n            content: \"您的文章将不会被保存\",\r\n            okText: \"确认\",\r\n            cancelText: \"取消\",\r\n            onOk: () => {\r\n                setIsAdd(false);\r\n                setFileList([]);\r\n            },\r\n        })\r\n    }\r\n\r\n    const getBase64 = (file) => { // 读取图片文件\r\n        return new Promise((resolve, reject) => {\r\n            const reader = new FileReader(); // 创建读取文件的对象\r\n            reader.readAsDataURL(file); // 读取文件的url\r\n            reader.onload = () => resolve(reader.result); // 返回文件内容\r\n            reader.onerror = (err) => reject(err);\r\n        })\r\n    }\r\n\r\n    const uploadButton = ( // 未上传图片时显示的按钮\r\n        <div>\r\n            <PlusOutlined/>\r\n            <div style={{marginTop: \"8px\"}}>上传封面</div>\r\n        </div>\r\n    )\r\n\r\n    const handlePreview = async (file) => { // 图片预览功能，在模态框中预览\r\n        if (!file.url && !file.preview) { // 如果文件没有打开且没有预览，则打开并且预览\r\n            file.preview = await getBase64(file.originFileObj);\r\n        }\r\n        setPreviewVisiable(true); // 显示模态框\r\n        setPreviewImage(file.url || file.preview); // 预览图片文件\r\n        setPreviewTitle(file.name || file.url.substring(file.url.lastIndexOf(\"/\") + 1)); // 上传图片的标题\r\n    }\r\n\r\n    const beforeUpload = (file) => { // 上传前的格式检查\r\n        const isCorrect = (file.type === \"image/jpeg\" || file.type === \"image/png\");\r\n        if (!isCorrect) {\r\n            message.error(\"请上传JPG或PNG格式的图片\");\r\n            return Upload.LIST_IGNORE;\r\n        }\r\n        return isCorrect;\r\n    }\r\n\r\n    const publish = async () => { // 点击发布之后弹出模态框\r\n        await addCaseRef.current.validateFields()\r\n            .then(value => {\r\n                if (value.braft == undefined || fileList.length == 0 || value.img == undefined || fileList[0].response == undefined) {\r\n                    message.info(\"请上传封面\");\r\n                    return;\r\n                }\r\n                Modal.confirm({\r\n                    title: \"你确定发布文章吗\",\r\n                    visible: publishVisiable,\r\n                    onCancel: setPublishVisiable(false),\r\n                    centered: true,\r\n                    okText: \"确定\",\r\n                    cancelText: \"取消\",\r\n                    onOk: () => submit()\r\n                })\r\n            })\r\n\r\n    }\r\n\r\n    const submit = async () => { // 发布文章\r\n        await addCaseRef.current.validateFields()\r\n            .then(value => {\r\n                const event = {\r\n                    name: value.name,\r\n                    img: fileList[0].response.imgPath,\r\n                    desc: value.desc,\r\n                    content: value.braft.toHTML(),\r\n                }\r\n                axios.post(`${HOST}:${PORT}/case/add`, {event: event})\r\n                    .then(result => {\r\n                        if (result.data.status === 201) {\r\n                            message.success(result.data.msg);\r\n                            setFileList([]);\r\n                            setTimeout(() => {\r\n                                setIsAdd(false);\r\n                            }, 1000);\r\n                            setState(!state);\r\n                        }\r\n                        if (result.data.status === 422) {\r\n                            message.info(\"请上传封面\");\r\n                        }\r\n                    }).catch(err => {\r\n                    console.log(err);\r\n                })\r\n            })\r\n    }\r\n\r\n    const addPage = () => { // 添加案例\r\n        return (\r\n            <div>\r\n                <PageHeader className={\"site-page-header\"} onBack={() => back()} title={\"编辑案例\"} extra={[\r\n                    <Button key={1} type={\"primary\"} onClick={() => back()}>取消编辑</Button>,\r\n                    <Button key={2} type={\"primary\"} onClick={() => publish()}>发布文章</Button>\r\n                ]}>\r\n                </PageHeader>\r\n                <Form ref={addCaseRef}>\r\n                    <Row align={\"center\"}>\r\n                        <Col span={23}>\r\n                            <Form.Item name={\"name\"} defaultValue={\"【无标题】\"}\r\n                                       rules={[{required: true, message: \"请输入文章标题\"}]}>\r\n                                <Input placeholder={\"请输入文章标题\"}\r\n                                       style={{borderRadius: \"24px\", height: \"40px\", padding: \"8px\"}}/>\r\n                            </Form.Item>\r\n                        </Col>\r\n                    </Row>\r\n                    <Row align={\"center\"}>\r\n                        <Col span={23}>\r\n                            <Form.Item name={\"braft\"} rules={[{required: true, message: \"请输入正文\"}]}>\r\n                                <BraftEditor placeholder={\"在这里输入正文\"} style={{border: \"1px solid #d9d9d9\"}}/>\r\n                            </Form.Item>\r\n                        </Col>\r\n                    </Row>\r\n                    <Row align={\"center\"}>\r\n                        <Col span={3}>\r\n                            <Form.Item name={\"img\"}>\r\n                                <Upload action={`${HOST}:${PORT}/case/upload`} // 上传\r\n                                        name={\"img\"} // 发到后台的文件参数名\r\n                                        listType={\"picture-card\"}\r\n                                        fileList={fileList} onChange={handleImgChange}\r\n                                        data={file => ({photoContent: file})} // 用户选择的文件\r\n                                        onPreview={handlePreview} beforeUpload={beforeUpload}>\r\n                                    {fileList.length >= 1 ? null : uploadButton}\r\n                                </Upload>\r\n                            </Form.Item>\r\n                        </Col>\r\n                        <Col span={13}>\r\n                            <Form.Item name={\"desc\"} rules={[{required: true, message: \"请输入文章摘要\"}]}>\r\n                                <TextArea placeholder={\"请输入文章摘要\"} autoSize={{minRows: 4, maxRows: 4}}\r\n                                          style={{width: \"700px\"}} showCount maxLength={255}></TextArea>\r\n                            </Form.Item>\r\n                        </Col>\r\n                    </Row>\r\n                </Form>\r\n                <Modal visible={previewVisiable} title={previewTitle}\r\n                       onCancel={() => setPreviewVisiable(false)} footer={null}>\r\n                    <img alt={\"example\"} style={{width: \"100%\"}} src={previewImage}/>\r\n                </Modal>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    // 查询所有的案例\r\n    const getAllCase = () => {\r\n        axios.get(`${HOST}:${PORT}/case/all`)\r\n            .then(result => {\r\n                if (result.data.status === 200) {\r\n                    setAllCase(result.data.data);\r\n                }\r\n            }).catch(err => {\r\n            console.log(err);\r\n        })\r\n    }\r\n\r\n    useEffect(() => getAllCase(), [state]); // 记录什么时候刷新数据\r\n\r\n    const casePage = () => { // 显示案例\r\n        return (\r\n            <div>\r\n                <Input.Group compact>\r\n                    <Input style={{width: \"200px\"}} placeholder={\"请输入案例名称\"}/>&nbsp;&nbsp;&nbsp;\r\n                    <Button type={\"primary\"}>搜索</Button>&nbsp;&nbsp;&nbsp;\r\n                    <Button type={\"primary\"} onClick={() => {\r\n                        setIsAdd(true);\r\n                    }}>添加</Button>\r\n                </Input.Group>\r\n                <div style={{marginTop: \"20px\"}}>\r\n                    {\r\n                        allCase.map(item => {\r\n                            return (\r\n                                <div key={item.id} style={{display: \"flex\", flexDirection: \"row\", flex: 1}}>\r\n                                    <Card hoverable>\r\n                                        <div style={{\r\n                                            width: \"220px\",\r\n                                            height: \"125px\",\r\n                                            border: \"1px solid black\"\r\n                                        }}>\r\n                                            <Image src={item.img} width={220} height={123.75} preview={false}\r\n                                                   placeholder={true}/>\r\n                                        </div>\r\n                                        <div style={{\r\n                                            marginLeft: \"20px\",\r\n                                            width: \"500px\", height: \"125px\",\r\n                                            backgroundColor: \"orange\"\r\n                                        }}>\r\n                                            <div style={{fontSize: \"20px\"}}>{item.name}</div>\r\n                                            <div style={{\r\n                                                backgroundColor: \"pink\",\r\n                                                marginTop: \"10px\"\r\n                                            }}>{item.desc}</div>\r\n                                        </div>\r\n                                        <div>\r\n                                            <div>\r\n                                                <Button>编辑</Button>\r\n                                                <Button>删除</Button>\r\n                                            </div>\r\n                                            <div>发布时间：{item.created_at}&nbsp;&nbsp;&nbsp;更新时间：{item.updated_at}</div>\r\n                                        </div>\r\n                                    </Card>\r\n                                </div>\r\n                            )\r\n                        })\r\n                    }\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <BrowserRouter>\r\n            <div style={{padding: \"30px 20px\"}}>\r\n                {isAdd ? addPage() : casePage()}\r\n            </div>\r\n        </BrowserRouter>\r\n    )\r\n}\r\n\r\nexport default Case;"]},"metadata":{},"sourceType":"module"}