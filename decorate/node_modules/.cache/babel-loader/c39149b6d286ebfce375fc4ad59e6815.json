{"ast":null,"code":"var _jsxFileName = \"E:\\\\\\u88C5\\u4FEE\\u5C0F\\u7A0B\\u5E8F\\\\decorate\\\\src\\\\components\\\\case.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from \"react\";\nimport { BrowserRouter } from \"react-router-dom\";\nimport { Button, Input, Card, PageHeader, Modal, Form, Upload, Row, Col, message } from \"antd\";\nimport BraftEditor from \"braft-editor\"; // 引入富文本编辑器\n\nimport \"braft-editor/dist/index.css\";\nimport { ExclamationCircleOutlined, PlusOutlined, VerticalAlignTopOutlined } from \"@ant-design/icons\";\nimport { HOST, PORT } from \"../config/apiconfig\";\nimport TextArea from \"antd/es/input/TextArea\"; // 引入css样式\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Case = function (props) {\n  _s();\n\n  const [isAdd, setIsAdd] = useState(false); // 记录是否是添加页面\n\n  const [fileList, setFileList] = useState([]); // 图片文件列表\n\n  const [previewVisiable, setPreviewVisiable] = useState(false); // 记录预览图片的模态框是否打开\n\n  const [previewTitle, setPreviewTitle] = useState(\"\"); // 模态框上现实的图片的标题\n\n  const [previewImage, setPreviewImage] = useState(\"\"); // 预览的图片文件\n\n  const addCaseRef = /*#__PURE__*/React.createRef(); // 与添加案例表单绑定\n\n  const handleImgChange = _ref => {\n    let {\n      fileList: newFileList\n    } = _ref;\n    // 点击上传图片之后，将上传的图片存放在数组\n    setFileList(newFileList);\n  };\n\n  const back = () => {\n    // 退出添加页面的模态框\n    Modal.confirm({\n      title: \"确认退出\",\n      icon: /*#__PURE__*/_jsxDEV(ExclamationCircleOutlined, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 26,\n        columnNumber: 19\n      }, this),\n      content: \"您的文章将不会被保存\",\n      okText: \"确认\",\n      cancelText: \"取消\",\n      onOk: () => {\n        setIsAdd(false);\n        setFileList([]);\n      }\n    });\n  };\n\n  const getBase64 = file => {\n    // 读取图片文件\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader(); // 创建读取文件的对象\n\n      reader.readAsDataURL(file); // 读取文件的url\n\n      reader.onload = () => resolve(reader.result); // 返回文件内容\n\n\n      reader.onerror = err => reject(err);\n    });\n  };\n\n  const uploadButton =\n  /*#__PURE__*/\n  // 未上传图片时显示的按钮\n  _jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(PlusOutlined, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: \"8px\"\n      },\n      children: \"\\u4E0A\\u4F20\\u5C01\\u9762\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 47,\n    columnNumber: 9\n  }, this);\n\n  const handlePreview = async file => {\n    // 图片预览功能，在模态框中预览\n    if (!file.url && !file.preview) {\n      // 如果文件没有打开且没有预览，则打开并且预览\n      file.preview = await getBase64(file.originFileObj);\n    }\n\n    setPreviewVisiable(true); // 显示模态框\n\n    setPreviewImage(file.url || file.preview); // 预览图片文件\n\n    setPreviewTitle(file.name || file.url.substring(file.url.lastIndexOf(\"/\") + 1)); // 上传图片的标题\n  };\n\n  const beforeUpload = file => {\n    // 上传前的格式检查\n    const isCorrect = file.type === \"image/jpeg\" || file.type === \"image/png\";\n\n    if (!isCorrect) {\n      message.error(\"请上传JPG或PNG格式的图片\");\n    }\n  };\n\n  const submit = async () => {\n    // 发布文章\n    await addCaseRef.current.validateFields().then(value => {\n      // console.log(value.braft.toHTML()); // 获取文章内容\n      // console.log(value.img)\n      console.log(fileList);\n    });\n  };\n\n  const addPage = () => {\n    // 添加案例\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(PageHeader, {\n        className: \"site-page-header\",\n        onBack: () => back(),\n        title: \"编辑案例\",\n        extra: [/*#__PURE__*/_jsxDEV(Button, {\n          type: \"primary\",\n          onClick: () => back(),\n          children: \"\\u53D6\\u6D88\\u7F16\\u8F91\"\n        }, 1, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          type: \"primary\",\n          onClick: () => submit(),\n          children: \"\\u53D1\\u5E03\\u6587\\u7AE0\"\n        }, 2, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 21\n        }, this)]\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Form, {\n        ref: addCaseRef,\n        children: [/*#__PURE__*/_jsxDEV(Row, {\n          align: \"center\",\n          children: /*#__PURE__*/_jsxDEV(Col, {\n            span: 23,\n            children: /*#__PURE__*/_jsxDEV(Form.Item, {\n              name: \"title\",\n              defaultValue: \"【无标题】\",\n              rules: [{\n                required: true,\n                message: \"请输入文章标题\"\n              }],\n              children: /*#__PURE__*/_jsxDEV(Input, {\n                placeholder: \"请输入文章标题\",\n                style: {\n                  borderRadius: \"24px\",\n                  height: \"40px\",\n                  padding: \"8px\"\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 91,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 89,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Row, {\n          align: \"center\",\n          children: /*#__PURE__*/_jsxDEV(Col, {\n            span: 23,\n            children: /*#__PURE__*/_jsxDEV(Form.Item, {\n              name: \"braft\",\n              rules: [{\n                required: true,\n                message: \"请输入正文\"\n              }],\n              children: /*#__PURE__*/_jsxDEV(BraftEditor, {\n                placeholder: \"在这里输入正文\",\n                style: {\n                  border: \"1px solid #d9d9d9\"\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 99,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 98,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Row, {\n          align: \"center\",\n          children: [/*#__PURE__*/_jsxDEV(Col, {\n            span: 3,\n            children: /*#__PURE__*/_jsxDEV(Form.Item, {\n              children: /*#__PURE__*/_jsxDEV(Upload, {\n                action: `${HOST}:${PORT}/case/upload` // 上传\n                ,\n                name: \"img\" // 发到后台的文件参数名\n                ,\n                listType: \"picture-card\",\n                fileList: fileList,\n                onChange: handleImgChange,\n                data: file => ({\n                  photoContent: file\n                }) // 用户选择的文件\n                ,\n                onPreview: handlePreview,\n                beforeUpload: () => false,\n                children: fileList.length >= 1 ? null : uploadButton\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 106,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 105,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Col, {\n            span: 13,\n            children: /*#__PURE__*/_jsxDEV(Form.Item, {\n              name: \"desc\",\n              rules: [{\n                required: true,\n                message: \"请输入文章摘要\"\n              }],\n              children: /*#__PURE__*/_jsxDEV(TextArea, {\n                placeholder: \"请输入文章摘要\",\n                autoSize: {\n                  minRows: 4,\n                  maxRows: 4\n                },\n                style: {\n                  width: \"700px\"\n                },\n                showCount: true,\n                maxLength: 255\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 118,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 117,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Modal, {\n        visible: previewVisiable,\n        title: previewTitle,\n        onCancel: () => setPreviewVisiable(false),\n        footer: null,\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          alt: \"example\",\n          style: {\n            width: \"100%\"\n          },\n          src: previewImage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 13\n    }, this);\n  };\n\n  const casePage = () => {\n    // 显示案例\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(Input.Group, {\n        compact: true,\n        children: [/*#__PURE__*/_jsxDEV(Input, {\n          style: {\n            width: \"200px\"\n          },\n          placeholder: \"请输入案例名称\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 21\n        }, this), \"\\xA0\\xA0\\xA0\", /*#__PURE__*/_jsxDEV(Button, {\n          type: \"primary\",\n          children: \"\\u641C\\u7D22\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 21\n        }, this), \"\\xA0\\xA0\\xA0\", /*#__PURE__*/_jsxDEV(Button, {\n          type: \"primary\",\n          onClick: () => {\n            setIsAdd(true);\n          },\n          children: \"\\u6DFB\\u52A0\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 13\n    }, this);\n  };\n\n  return /*#__PURE__*/_jsxDEV(BrowserRouter, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: \"30px 20px\"\n      },\n      children: isAdd ? addPage() : casePage()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 155,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Case, \"VYVwguUQKVfZYg6IteCMKcJfqzU=\");\n\n_c = Case;\nexport default Case;\n\nvar _c;\n\n$RefreshReg$(_c, \"Case\");","map":{"version":3,"sources":["E:/装修小程序/decorate/src/components/case.js"],"names":["React","useState","BrowserRouter","Button","Input","Card","PageHeader","Modal","Form","Upload","Row","Col","message","BraftEditor","ExclamationCircleOutlined","PlusOutlined","VerticalAlignTopOutlined","HOST","PORT","TextArea","Case","props","isAdd","setIsAdd","fileList","setFileList","previewVisiable","setPreviewVisiable","previewTitle","setPreviewTitle","previewImage","setPreviewImage","addCaseRef","createRef","handleImgChange","newFileList","back","confirm","title","icon","content","okText","cancelText","onOk","getBase64","file","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","err","uploadButton","marginTop","handlePreview","url","preview","originFileObj","name","substring","lastIndexOf","beforeUpload","isCorrect","type","error","submit","current","validateFields","then","value","console","log","addPage","required","borderRadius","height","padding","border","photoContent","length","minRows","maxRows","width","casePage"],"mappings":"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","sourcesContent":["import React, {useState} from \"react\";\r\nimport {BrowserRouter} from \"react-router-dom\";\r\nimport {Button, Input, Card, PageHeader, Modal, Form, Upload, Row, Col, message} from \"antd\";\r\nimport BraftEditor from \"braft-editor\"; // 引入富文本编辑器\r\nimport \"braft-editor/dist/index.css\";\r\nimport {ExclamationCircleOutlined, PlusOutlined, VerticalAlignTopOutlined} from \"@ant-design/icons\";\r\nimport {HOST, PORT} from \"../config/apiconfig\";\r\nimport TextArea from \"antd/es/input/TextArea\"; // 引入css样式\r\n\r\nconst Case = function (props) {\r\n    const [isAdd, setIsAdd] = useState(false); // 记录是否是添加页面\r\n    const [fileList, setFileList] = useState([]); // 图片文件列表\r\n    const [previewVisiable, setPreviewVisiable] = useState(false); // 记录预览图片的模态框是否打开\r\n    const [previewTitle, setPreviewTitle] = useState(\"\"); // 模态框上现实的图片的标题\r\n    const [previewImage, setPreviewImage] = useState(\"\"); // 预览的图片文件\r\n\r\n    const addCaseRef = React.createRef(); // 与添加案例表单绑定\r\n\r\n    const handleImgChange = ({fileList: newFileList}) => { // 点击上传图片之后，将上传的图片存放在数组\r\n        setFileList(newFileList);\r\n    }\r\n\r\n    const back = () => { // 退出添加页面的模态框\r\n        Modal.confirm({\r\n            title: \"确认退出\",\r\n            icon: <ExclamationCircleOutlined/>,\r\n            content: \"您的文章将不会被保存\",\r\n            okText: \"确认\",\r\n            cancelText: \"取消\",\r\n            onOk: () => {\r\n                setIsAdd(false);\r\n                setFileList([]);\r\n            },\r\n        })\r\n    }\r\n\r\n    const getBase64 = (file) => { // 读取图片文件\r\n        return new Promise((resolve, reject) => {\r\n            const reader = new FileReader(); // 创建读取文件的对象\r\n            reader.readAsDataURL(file); // 读取文件的url\r\n            reader.onload = () => resolve(reader.result); // 返回文件内容\r\n            reader.onerror = (err) => reject(err);\r\n        })\r\n    }\r\n\r\n    const uploadButton = ( // 未上传图片时显示的按钮\r\n        <div>\r\n            <PlusOutlined/>\r\n            <div style={{marginTop: \"8px\"}}>上传封面</div>\r\n        </div>\r\n    )\r\n\r\n    const handlePreview = async (file) => { // 图片预览功能，在模态框中预览\r\n        if (!file.url && !file.preview) { // 如果文件没有打开且没有预览，则打开并且预览\r\n            file.preview = await getBase64(file.originFileObj);\r\n        }\r\n        setPreviewVisiable(true); // 显示模态框\r\n        setPreviewImage(file.url || file.preview); // 预览图片文件\r\n        setPreviewTitle(file.name || file.url.substring(file.url.lastIndexOf(\"/\") + 1)); // 上传图片的标题\r\n    }\r\n\r\n    const beforeUpload = (file) => { // 上传前的格式检查\r\n        const isCorrect = (file.type === \"image/jpeg\" || file.type === \"image/png\");\r\n        if (!isCorrect) {\r\n            message.error(\"请上传JPG或PNG格式的图片\");\r\n        }\r\n    }\r\n\r\n    const submit = async () => { // 发布文章\r\n        await addCaseRef.current.validateFields()\r\n            .then(value => {\r\n                // console.log(value.braft.toHTML()); // 获取文章内容\r\n                // console.log(value.img)\r\n                console.log(fileList)\r\n            })\r\n    }\r\n\r\n    const addPage = () => { // 添加案例\r\n        return (\r\n            <div>\r\n                <PageHeader className={\"site-page-header\"} onBack={() => back()} title={\"编辑案例\"} extra={[\r\n                    <Button key={1} type={\"primary\"} onClick={() => back()}>取消编辑</Button>,\r\n                    <Button key={2} type={\"primary\"} onClick={() => submit()}>发布文章</Button>\r\n                ]}>\r\n                </PageHeader>\r\n                <Form ref={addCaseRef}>\r\n                    <Row align={\"center\"}>\r\n                        <Col span={23}>\r\n                            <Form.Item name={\"title\"} defaultValue={\"【无标题】\"}\r\n                                       rules={[{required: true, message: \"请输入文章标题\"}]}>\r\n                                <Input placeholder={\"请输入文章标题\"}\r\n                                       style={{borderRadius: \"24px\", height: \"40px\", padding: \"8px\"}}/>\r\n                            </Form.Item>\r\n                        </Col>\r\n                    </Row>\r\n                    <Row align={\"center\"}>\r\n                        <Col span={23}>\r\n                            <Form.Item name={\"braft\"} rules={[{required: true, message: \"请输入正文\"}]}>\r\n                                <BraftEditor placeholder={\"在这里输入正文\"} style={{border: \"1px solid #d9d9d9\"}}/>\r\n                            </Form.Item>\r\n                        </Col>\r\n                    </Row>\r\n                    <Row align={\"center\"}>\r\n                        <Col span={3}>\r\n                            <Form.Item>\r\n                                <Upload action={`${HOST}:${PORT}/case/upload`} // 上传\r\n                                        name={\"img\"} // 发到后台的文件参数名\r\n                                        listType={\"picture-card\"}\r\n                                        fileList={fileList} onChange={handleImgChange}\r\n                                        data={(file) => ({photoContent: file})} // 用户选择的文件\r\n                                        onPreview={handlePreview} beforeUpload={() => false}>\r\n                                    {fileList.length >= 1 ? null : uploadButton}\r\n                                </Upload>\r\n                            </Form.Item>\r\n                        </Col>\r\n                        <Col span={13}>\r\n                            <Form.Item name={\"desc\"} rules={[{required: true, message: \"请输入文章摘要\"}]}>\r\n                                <TextArea placeholder={\"请输入文章摘要\"} autoSize={{minRows: 4, maxRows: 4}}\r\n                                          style={{width: \"700px\"}} showCount maxLength={255}></TextArea>\r\n                            </Form.Item>\r\n                        </Col>\r\n                    </Row>\r\n                </Form>\r\n                <Modal visible={previewVisiable} title={previewTitle}\r\n                       onCancel={() => setPreviewVisiable(false)} footer={null}>\r\n                    <img alt={\"example\"} style={{width: \"100%\"}} src={previewImage}/>\r\n                </Modal>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    const casePage = () => { // 显示案例\r\n        return (\r\n            <div>\r\n                <Input.Group compact>\r\n                    <Input style={{width: \"200px\"}} placeholder={\"请输入案例名称\"}/>&nbsp;&nbsp;&nbsp;\r\n                    <Button type={\"primary\"}>搜索</Button>&nbsp;&nbsp;&nbsp;\r\n                    <Button type={\"primary\"} onClick={() => {\r\n                        setIsAdd(true);\r\n                    }}>添加</Button>\r\n                </Input.Group>\r\n                {/*<Table  style={{marginTop: \"20px\"}}></Table>*/}\r\n                {/*<div style={{marginTop: \"20px\"}}>*/}\r\n                {/*    {*/}\r\n                {/*        <Card hoverable>*/}\r\n\r\n                {/*        </Card>*/}\r\n                {/*    }*/}\r\n                {/*</div>*/}\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <BrowserRouter>\r\n            <div style={{padding: \"30px 20px\"}}>\r\n                {isAdd ? addPage() : casePage()}\r\n            </div>\r\n        </BrowserRouter>\r\n    )\r\n}\r\n\r\nexport default Case;"]},"metadata":{},"sourceType":"module"}